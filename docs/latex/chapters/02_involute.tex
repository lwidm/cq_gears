\section{The Involute Curve}
\label{sec:involute}
\subsection{Geometric Construction}
Figure~\ref{fig:rack-geometry} shows a gear interacting with a rack, with the relevant geometry overlaid:
base circle (\emph{Grundkreis}), pitch circle (\emph{Teilkreis}), addendum and dedendum circles (\emph{Kopf- und Fusskreis}), and the line of action (\emph{Eingriffslinie}).
The involute curve originates from the base circle and defines the tooth flank.
\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{de-evolventenverzahnung-zahnstange-eingriff.jpg}
    \caption{Rack and pinion~(\fullcite{tecScience_zahnstange})}
    \label{fig:rack-geometry}
\end{figure}
\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{de-evolventenverzahnung-kreis-evolvente-eingriffswinkel-flankenform.jpg}
    \caption{Involute geometry and pressure angle~(\fullcite{tecScience_konstruktion_evolvente})}
    \label{fig:involute-geometry}
\end{figure}
The YouTube video by Gergely Bencsik~\cite{involute_YTvideo} shows how the involute originates in a very intuitive way. For deriving the parametric equation, it is easier to think of the involute as the curve traced by the end of a taut string unwinding from the base circle (see Figure~\ref{fig:involute_construction}, right).

\begin{figure}[htbp]
    \centering
    {
        \iflocal
            \href{run:../assets/involute_line.mp4}{%
                \includegraphics[width=0.47\linewidth]{../assets/involute_line.png}
            }%
            \href{run:../assets/involute_string.mp4}{%
                \includegraphics[width=0.47\linewidth]{../assets/involute_string.png}
            }%
        \else
            \href{https://lwidm.github.io/cq_gears/involute_line.mp4}{%
                \includegraphics[width=0.47\linewidth]{../assets/involute_line.png}
            }%
            \href{https://lwidm.github.io/cq_gears/involute_string.mp4}{%
                \includegraphics[width=0.47\linewidth]{../assets/involute_string.png}
            }%
        \fi
        \caption{Two equivalent constructions of the involute of a circle. Left: the involute generated by a straight line rolling without slipping along the base circle. Right: the same curve obtained by unwinding a taut string from the circle. The images link to the corresponding videos on GitHub.}
        \label{fig:involute_construction}
    }
\end{figure}

Figure~\ref{fig:involute_construction} illustrates two equivalent geometric constructions. The key insight from the unwinding-string construction (right) is that the length of the blue arrow equals the arc length spanned by the base circle at angle $\phi$.

\subsection{Parametric Equation}
Looking at Figure~\ref{fig:involute_construction}, the parametric equation can be separated into two components (yellow and blue arrow). The yellow arrow has magnitude $\frac{d_b}{2}$, and the blue arrow has magnitude equal to the arc length, i.e. $\frac{d_b}{2}\phi$.

\begin{equation}
\begin{bmatrix}
x(\phi) \\
y(\phi)
\end{bmatrix}
= \textcolor[rgb]{0.8,0.8,0}{\frac{d_b}{2} \begin{bmatrix}
\cos(\phi) \\
\sin(\phi)
\end{bmatrix}}
+ \textcolor{blue}{\frac{d_b}{2}\phi \begin{bmatrix}
\sin(\phi) \\
-\cos(\phi)
\end{bmatrix}}
\end{equation}

\subsection{Parameter \texorpdfstring{$\phi(d^*)$}{φ(d*)} at a Given Diameter}
To avoid extending the involute beyond the relevant geometry, it is useful to know at which $\phi$ a certain diameter (e.g. the addendum diameter $d_a$) is reached. The following is the derivation of $\phi(d^*)$, where $d^*$ is an arbitrary diameter.

\begin{subequations}
\begin{align}
d^* &\stackrel{!}{=} \sqrt{x(\phi^*)^2 + y(\phi^*)^2}\cdot2 \\
(d^*/2)^2 &= x(\phi^*)^2 + y(\phi^*)^2 \\
(d^*/2)^2 &= \left(\frac{d_b}{2}\cos\phi^* + \frac{d_b}{2}\phi^* \sin\phi^*\right)^2 + \left(\frac{d_b}{2}\sin\phi^* - \frac{d_b}{2}\phi^* \cos\phi^*\right)^2 \\
(d^*/2)^2 &= \frac{d_b^2}{4}(\cos^2\phi^* + \sin^2\phi^*) + \frac{d_b^2}{4}{\phi^*}^2(\sin^2\phi^* + \cos^2\phi^*) \\
(d^*/2)^2 &= \frac{d_b^2}{4}(1 + {\phi^*}^2) \\
{d^*}^2 &= d_b^2(1 + {\phi^*}^2) \\
{\phi^*}^2 &= \frac{{d^*}^2}{d_b^2} - 1 = \frac{{d^*}^2 - d_b^2}{d_b^2} \\
\phi^* &= \pm\frac{\sqrt{{d^*}^2 - d_b^2}}{d_b} \\
       &= \pm\left[\left(\frac{d^* }{d_b}\right)^2 - 1\right]^{\frac{1}{2}}
\end{align}
\end{subequations}

Note: The positive solution is valid for the right flank (counterclockwise rotating involute) and the negative solution holds for the left flank (clockwise rotating involute)

\subsection{Involute Angle \texorpdfstring{$\theta(d^*)$}{θ(d*)} at a Given Diameter}
\label{subsec:involute_angle}
In order to create a full tooth the involute needs to be mirrored by the x-axis (or a left involute and a right involute need to be placed correctly). But since only the tooth thickness at the \textbf{pitch circle} is known, the angle between the x-axis and the involute point at $d^*(\phi)=d_p$ must first be determined. This is required since the involute starts at $y=0$ (meaning the point crossing the pitch circle is at $y>0$). The involute can then be rotated by $\theta(d_p)$, placing the pitch circle crossing point at $y=0$, and later rotated again by the half tooth angle to position the curve correctly.

\paragraph{a)} determine $x(\phi^*)$
\begin{subequations}
\begin{align}
x(\phi^*) &= \frac{d_b}{2}\cos\phi^* + \frac{d_b}{2}\phi^*\sin\phi^*\\
&=\frac{d_b}{2}\cos\left(\pm\frac{\sqrt{{d^*}^2 - d_b^2}}{d_b}\right) \pm \frac{d_b}{2}\frac{\sqrt{{d^*}^2 - d_b^2}}{d_b}\sin\left(\pm\frac{\sqrt{{d^*}^2 - d_b^2}}{d_b}\right) \\
&=\frac{d_b}{2}\cos\left(\pm\frac{\sqrt{{d^*}^2 - d_b^2}}{d_b}\right) \pm \frac{\sqrt{{d^*}^2 - d_b^2}}{2}\sin\left(\pm\frac{\sqrt{{d^*}^2 - d_b^2}}{d_b}\right)
\end{align}
\end{subequations}

\paragraph{b)} determine $y(\phi^*)$
\begin{subequations}
\begin{align}
y(\phi^*) &= \frac{d_b}{2}\sin\phi^* - \frac{d_b}{2}\phi^*\cos\phi^*\\
&=\frac{d_b}{2}\sin\left(\pm\frac{\sqrt{{d^*}^2 - d_b^2}}{d_b}\right) \mp \frac{d_b}{2}\frac{\sqrt{{d^*}^2 - d_b^2}}{d_b}\cos\left(\pm\frac{\sqrt{{d^*}^2 - d_b^2}}{d_b}\right) \\
&=\frac{d_b}{2}\sin\left(\pm\frac{\sqrt{{d^*}^2 - d_b^2}}{d_b}\right) \mp \frac{\sqrt{{d^*}^2 - d_b^2}}{2}\cos\left(\pm\frac{\sqrt{{d^*}^2 - d_b^2}}{d_b}\right)
\end{align}
\end{subequations}

\paragraph{c)} Compute $\tan(y/x)$
\begin{subequations}
\begin{align}
\theta(\phi^*) &= \arctan\frac{y(\phi^*)}{x(\phi^*)} \\
 &= \arctan\frac{\frac{d_b}{2}\sin\phi^* - \frac{d_b}{2}\phi^*\cos\phi^*}{\frac{d_b}{2}\cos\phi^* + \frac{d_b}{2}\phi^*\sin\phi^*} \\
 &= \arctan\frac{\sin\phi^* - \phi^*\cos\phi^*}{\cos\phi^* + \phi^*\sin\phi^*} 
 \textcolor{orange}{\cdot \frac{1/\cos\phi^*}{1/\cos\phi^*}}\\
 &= \arctan\frac{\tan\phi^* - \phi^*}{1 + \phi^*\tan\phi^*} \label{eq:involute_angle_unsimplified} 
\end{align}
\end{subequations}

\paragraph{d)} Simplify using tangent subtraction / addition formula:

The tangent subtraction / addition formula reads
\begin{equation}
\tan(\alpha \pm \beta) = \frac{\tan\alpha \pm \tan\beta}{1\mp\tan\alpha\tan{\beta}}
\label{eq:tangent_subtraction_formula}
\end{equation}

Inserting $\alpha=\phi^*$ and $\beta=\arctan\phi^*$ into eq~\eqref{eq:tangent_subtraction_formula} above (only considering subtraction):
\begin{subequations}
\begin{align}
    \tan\left(\phi^* - \arctan(\phi^*)\right) &= \frac{\tan(\phi^*) - \tan(\arctan(\phi^*))}{1+\tan(\phi^*)\tan(\arctan(\phi^*))}
    \\
    \tan\left(\phi^* - \arctan(\phi^*)\right) &= \frac{\tan(\phi^*) - \phi^*}{1 + \phi^*\tan(\phi^*)}
    \\
    \phi^* - \arctan(\phi^*) &= \arctan\frac{\tan(\phi^*) - \phi^*}{1 + \phi^*\tan(\phi^*)} \label{eq:inserted_tangent_subtraction_formula}
\end{align}
\end{subequations}

Comparing eq.~\eqref{eq:involute_angle_unsimplified} and eq.~\eqref{eq:inserted_tangent_subtraction_formula} gives:
\begin{equation}
    \theta(\phi^*) = \phi^* - \arctan\phi^*
\end{equation}

After all this derivation, the result is, of course (d'oh!), just the well-known involute function $\operatorname{inv}(\phi) = \phi - \arctan(\phi)$.

\paragraph{e)} Insert $\phi^* = \pm\left[\left(\frac{d^* }{d_b}\right)^2 - 1\right]^{\frac{1}{2}}$
\begin{equation}
\theta(d^*) = \pm\left[\left(\frac{d^*}{d_b}\right)^2 - 1\right]^{\tfrac{1}{2}} - \arctan\left(\pm\left[\left(\frac{d^*}{d_b}\right)^2 - 1\right]^{\tfrac{1}{2}}\right)
\end{equation}

\subsection{Summary}
\begin{subequations}
\begin{align}
\vb{r_{inv}}(\phi) = 
\begin{bmatrix}
x(\phi) \\
y(\phi)
\end{bmatrix}
&= \tfrac{d_b}{2} \begin{bmatrix}
\cos(\phi) \\
\sin(\phi)
\end{bmatrix}
+ \tfrac{d_b}{2}\phi \begin{bmatrix}
\sin(\phi) \\
-\cos(\phi)
\end{bmatrix} \\
\phi(d^*) &= \mypm\left[\left(\frac{d^* }{d_b}\right)^2 - 1\right]^{\frac{1}{2}}\\
\theta(d^*) &=  \mypm\left[\left(\frac{d^*}{d_b}\right)^2 - 1\right]^{\tfrac{1}{2}} - \arctan\left(\mypm\left[\left(\frac{d^*}{d_b}\right)^2 - 1\right]^{\tfrac{1}{2}}\right)
\end{align}
\end{subequations}

\textbf{Note:} The $\mypm$ as well as the monotonicity of $\phi$ depends on which flank
\begin{itemize}
    \item $\textcolor{red}{+}$: Right flank (involute rotating counterclockwise) $\Rightarrow$ $\phi$ is monotonically increasing\newline
        $\phi_{start} < \phi_{end}$, usually: $\phi_{start} = 0$  and  $\phi_{end} > 0$
    \item $\textcolor{red}{-}$: Left flank (involute rotating clockwise) $\Rightarrow$ $\phi$ is monotonically decreasing\newline
        $\phi_{start} > \phi_{end}$, usually: $\phi_{start} = 0$  and  $\phi_{end} < 0$
\end{itemize}
