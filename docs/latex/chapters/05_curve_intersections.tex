\section{Curve Intersections}

\subsection{Newton-Raphson Method}
Finding analytical solutions for the intersections between the two curves is extremely difficult, so a numerical approach is used instead. Specifically, the Newton-Raphson method provides an iterative way to find roots of nonlinear equations.

\paragraph{1D Newton-Raphson}
For a single variable, the method iteratively refines an estimate of the root:
\begin{equation}
\begin{gathered}
f(x) \stackrel{!}{=} 0 \\
x^{k+1} = x^k - \frac{f(x^k)}{f'(x^k)}
\end{gathered}
\label{eq:1D_newton_raphson}
\end{equation}

\paragraph{2D Newton-Raphson}
For systems of two equations, the derivative is replaced by the Jacobian matrix. Given a vector function $\vb F$ and its Jacobian $\vb J$, the iteration becomes:
\begin{equation}
\begin{gathered}
    \vb F(\vb x) = \begin{bmatrix} f_1(x_1, x_2) \\ f_2(x_1, x_2) \end{bmatrix} \stackrel{!}{=} \vb 0
    \\[1ex]
    \vb J(\vb x) = \begin{bmatrix} J_{11} & J_{12} \\ J_{21} & J_{22} \end{bmatrix} = \begin{bmatrix} \pdv{f_1}{x_1} & \pdv{f_1}{x_2} \\ \pdv{f_2}{x_1} & \pdv{f_2}{x_2} \end{bmatrix}
    \\[1ex]
    \vb J^{-1} = \frac{1}{J_{11}J_{22} - J_{12}J_{21}} \begin{bmatrix}J_{22} & - J_{12} \\ -J_{21} & J_{11}\end{bmatrix}
    \\[1ex]
\vb x^{k+1} = \vb x^k - \vb J^{-1}(\vb x^k)\;\vb F(\vb x^k)
\end{gathered}
\label{eq:2D_newton_raphson}
\end{equation}

\subsection{Left–Right Involute Intersection}
In certain configurations, particularly when profile shift is applied, the left and right involute flanks of a tooth may intersect before reaching the dedendum circle. When this occurs, the involute curves must be truncated at their intersection point rather than extending to the dedendum. To determine this intersection, the positioned involute equations are set equal. The right and left involutes are rotated by $-\gamma$ and $+\gamma$ respectively:
\begin{subequations}
\begin{align}
    &\vb{r_{inv,pos,right}}(\phi) = \vb{R}(-\gamma)\;\vb{r_{inv}}(\phi)
\nonumber\\[1ex]
    &\phantom{\vb{r_{inv,po}}}= \frac{d_b}{2} \begin{bmatrix}
        \phantom{-}\cos(\gamma)\;\cos(\phi) +\cos(\gamma)\;\phi \sin(\phi) + \sin(\gamma)\;\sin(\phi) - \sin(\gamma)\;\phi\cos(\phi)\\
        -\sin(\gamma)\;\cos(\phi) - \sin(\gamma)\;\phi \sin(\phi) + \cos(\gamma)\;\sin(\phi) - \cos(\gamma)\;\phi\cos(\phi)\\
    \end{bmatrix}
\\[2ex]
    &\vb{r_{inv,pos,left}}(\phi) = \vb{R}(\gamma)\;\vb{r_{inv}}(\phi)
\nonumber\\[1ex]
    &\phantom{\vb{r_{inv,po}}} = \frac{d_b}{2}
    \begin{bmatrix}
        \phantom{-}\cos(\phantom{-}\gamma)\;\cos(\phi) +\cos(\phantom{-}\gamma)\;\phi \sin(\phi) + \sin(-\gamma)\;\sin(\phi) - \sin(-\gamma)\;\phi\cos(\phi)\\
        -\sin(-\gamma)\;\cos(\phi) - \sin(-\gamma)\;\phi \sin(\phi) + \cos(\phantom{-}\gamma)\;\sin(\phi) - \cos(\phantom{-}\gamma)\;\phi\cos(\phi)\\
    \end{bmatrix}
\end{align}
\end{subequations}

\paragraph{Equating Components}
Setting the two curves equal yields two equations, one for each component.

The $x$-component gives:
\begin{equation}
\begin{aligned}
\cos(\gamma)\;\cos(\phi_r) &+ \cos(\gamma)\;\phi_r \sin(\phi_r) + \sin(\gamma)\;\sin(\phi_r) - \sin(\gamma)\;\phi_r\cos(\phi_r)\\
&= \cos(\gamma)\;\cos(\phi_l) +\cos(\gamma)\;\phi_l \sin(\phi_l) - \sin(\gamma)\;\sin(\phi_l) + \sin(\gamma)\;\phi_l\cos(\phi_l)
\end{aligned}
\end{equation}

The $y$-component gives:
\begin{equation}
\begin{aligned}
-\sin(\gamma)\;\cos(\phi_r) &- \sin(\gamma)\;\phi_r \sin(\phi_r) + \cos(\gamma)\;\sin(\phi_r) - \cos(\gamma)\;\phi_r\cos(\phi_r)\\
&= \sin(\gamma)\;\cos(\phi_l) + \sin(\gamma)\;\phi_l \sin(\phi_l) + \cos(\gamma)\;\sin(\phi_l) - \cos(\gamma)\;\phi_l\cos(\phi_l)
\end{aligned}
\end{equation}

\paragraph{Symmetry Argument}
Due to the symmetry of the two curves, the ansatz $\phi_r = -\phi_l = \phi$ is proposed. This can be verified by substituting into the $x$-component equation, which yields:
\begin{equation}
\begin{aligned}
    &\phantom{=}\,\;\cos(\gamma)\;\cos(\phi)_l + \cos(\gamma)\;\phi \sin(\phi) + \sin(\gamma)\;\sin(\phi) - \sin(\gamma)\;\phi\cos(\phi)
\\
    &= \cos(\gamma)\;\cos(\phi) + \cos(\gamma)\;\phi \sin(\phi) + \sin(\gamma)\;\sin(\phi) - \sin(\gamma)\;\phi\cos(\phi)
\end{aligned}
\end{equation}
Both sides are identical, confirming the symmetry assumption is valid.

\paragraph{Deriving the Intersection Condition}
Inserting $\phi_r = -\phi_l = \phi$ into the $y$-component equation:
\begin{equation}
\begin{aligned}
&\phantom{=}\,\; -\sin(\gamma)\;\cos(\phi) - \sin(\gamma)\;\phi \sin(\phi) + \cos(\gamma)\;\sin(\phi) - \cos(\gamma)\;\phi\cos(\phi)\\
&=
\phantom{-}\sin(\gamma)\;\cos(\phi) + \sin(\gamma)\;\phi \sin(\phi) - \cos(\gamma)\;\sin(\phi) + \cos(\gamma)\;\phi\cos(\phi)
\end{aligned}
\end{equation}

Taking the difference (RHS $-$ LHS $= 0$) and simplifying:

\begin{subequations}
\begin{align}
    2\sin(\gamma)\cos(\phi) + 2\sin(\gamma)\phi\sin(\phi) - 2\cos(\gamma)\sin(\phi) + 2\cos(\gamma)\phi\cos(\phi) &= 0\\
    \sin(\gamma)\cos(\phi) + \sin(\gamma)\phi\sin(\phi) - \cos(\gamma)\sin(\phi) + \cos(\gamma)\phi\cos(\phi) &= 0\\
    \sin(\gamma)\left[\cos(\phi) + \phi\sin(\phi)\right] - \cos(\gamma)\left[\sin(\phi) - \phi\cos(\phi)\right]&= 0
\end{align}
\vspace*{-2.5em}
\begin{align}
    \sin(\gamma)\left[\cos(\phi) + \phi\sin(\phi)\right] &= \cos(\gamma)\left[\sin(\phi) - \phi\cos(\phi)\right]\\
    \tan(\gamma) &= \frac{\sin(\phi) - \phi\cos(\phi)}{\cos(\phi) + \phi\sin(\phi)}\\
    \frac{\sin(\phi) - \phi\cos(\phi)}{\cos(\phi) + \phi\sin(\phi)} - \tan(\gamma) &=0
\end{align}
\end{subequations}

\subsubsection{Applying Newton-Raphson}
This means we need to solve the following equation with Newton-Raphson:
\begin{align}
f(\phi) = \frac{\sin(\phi) - \phi\cos(\phi)}{\cos(\phi) + \phi\sin(\phi)} - \tan(\gamma) &=0\\
\end{align}
For this we need to compute the derivative of $f(\phi)$ first

\paragraph{Derivate of $f(x)$}
\begin{enumerate}[label=\alph*)]
    \item Split into components
        \begin{equation}
            \begin{gathered}
                f(\phi) = \frac{u(\phi)}{v(\phi)} -C\\
                \begin{aligned}
                    u(\phi) &=\sin(\phi) - \phi \cos(\phi) \\
                    v(\phi) &=\cos(\phi) + \phi \sin(\phi) \\
                    C &= \tan(\gamma)
                \end{aligned}
            \end{gathered}
        \end{equation}
    \item compute $u'(\phi)$
        \begin{equation}
            \begin{aligned}
                u'(\phi)    &= \cos(\phi) - \cos(\phi) + \phi\sin(\phi) \\
                            &= \phi\sin(\phi)
            \end{aligned}
        \end{equation}
    \item compute $v'(\phi)$
        \begin{equation}
            \begin{aligned}
                v'(\phi)    &= -\sin(\phi) + \sin(\phi) + \phi\cos(\phi) \\
                            &= \phi\cos(\phi)
            \end{aligned}
        \end{equation}
    \item apply quotient rule
        \begin{equation}
            \dv{}{\phi}\left[\frac{u(\phi)}{v(\phi)}\right] = \frac{u'\;v - u\;v'}{v^2}
        \end{equation}
        \begin{align}
            \dv{f(\phi)}{\phi} & = \frac{u'\;v - u\;v'}{v^2} \\
                &= \frac{
                    \phi\sin(\phi)\cdot\left[\cos(\phi) + \phi\sin(\phi)\right] - \phi\cos(\phi)\cdot\left[\sin(\phi) - \phi\cos(\phi)\right]
                    }
                    {\left[\cos(\phi) + \phi\sin(\phi)\right]^2}\\[1ex]
                &= \frac{
                    \cancel{\phi\sin(\phi)\cos(\phi)} + \phi^2\sin^2(\phi) \cancel{ -\phi\sin(\phi)\cos(\phi)} + \phi^2\cos^2(\phi)
                    }
                    {\left[\cos(\phi) + \phi\sin(\phi)\right]^2}\\[1ex]
                &= \frac{
                    \phi^2\cancelto{1}{\left[\sin^2(\phi) + \cos^2(\phi)\right]}
                    }
                    {\left[\cos(\phi) + \phi\sin(\phi)\right]^2}\\[1ex]
                &= \frac{\phi^2}{\left[\cos(\phi) + \phi\sin(\phi)\right]^2}
        \end{align}
\end{enumerate}

\paragraph{Formulate Newton-Raphson}
\begin{align}
    \phi_{n+1} &= \phi_n - \frac{F(\phi_n)}{F'(\phi_n)} \\
                &= \phi_n - \left(\frac{\sin(\phi_n) - \phi_n\cos(\phi_n)}{\cos(\phi_n) + \phi_n\sin(\phi_n)} - \tan(\gamma)\right)
                    \frac{\left[\cos(\phi_n) + \phi_n\sin(\phi_n)\right]^2}{\phi_n^2}\\[1ex]
                 &= \phi_n - \frac{\cos(\phi_n) + \phi_n\sin(\phi_n)}{\phi_n^2}\left(\sin(\phi_n) - \phi_n\cos(\phi_n) - \tan(\gamma)\;\left[\cos(\phi_n) + \phi_n\sin(\phi_n)\right]\right)
\end{align}
or more presentable:
\begin{equation}
    \begin{gathered}
        \phi_{n+1} = \phi_n - \frac{a}{\phi_n^2}\left(b - \tan(\gamma)\;a\right)\\[1ex]
        a =\cos(\phi_n) + \phi_n\sin(\phi_n) \qq{and} b=\sin(\phi_n) - \phi_n\cos(\phi_n)
    \end{gathered}
\end{equation}


\subsection{Involute–Hypotrochoid Intersection}
    \subsubsection{System of Equations}
    \subsubsection{Jacobian Matrix}
    \subsubsection{Newton-Raphson Iteration}
